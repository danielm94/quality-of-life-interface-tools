on_startup = {
	edict_commander_set_all_trade_node_flags = yes
	set_all_movement_edict_flags = yes
}

on_province_religion_converted = {
	if = {
		limit = {
			owner = {
				ai = no
			}
			is_state = yes
			has_state_edict = edict_religious_unity
			religion = owner
		}
		owner = {
			save_event_target_as = province_owner
		}
		set_variable = {
			which = remove_the_edict
			value = 1
		}
		every_province_in_state = {
			limit = {
				owned_by = event_target:province_owner
			}
			save_event_target_as = province_to_check
			if = {
				limit = {
					NOT = {
						religion = event_target:province_owner
					}
					NOT = {
						event_target:province_owner = {
							has_harmonized_with = event_target:province_to_check
						}
					}
					NOT = {
						event_target:province_owner = {
							secondary_religion = event_target:province_to_check
						}
					}
				}
				set_variable = {
					which = remove_the_edict
					value = 0
				}
			}
		}
		if = {
			limit = {
				check_variable = {
					which = remove_the_edict
					value = 1
				}
			}
			set_state_edict = no_edict
		}
	}
}

on_siege_lost_province = {
	if = {
		limit = {
			owner = {
				ai = no
			}
			NOT = {
				has_state_edict = edict_defensive_edict
			}
		}
		if = {
			limit = {
				any_province_in_state = {
					has_fort_building_trigger = yes
					controlled_by = owner
				}
			}
			edict_commander_set_edict_for_state = {
				edict = edict_defensive_edict
			}
		}
	}
}

on_adm_development = {
	if = {
		limit = {
			owner = {
				ai = no
			}
			is_state = yes
			can_change_state_edict = yes
			NOT = {
				has_state_edict = edict_encourage_development
			}
		}
		edict_commander_set_edict_for_state = {
			edict = edict_encourage_development
		}
	}
}

on_dip_development = {
	if = {
		limit = {
			owner = {
				ai = no
			}
			is_state = yes
			can_change_state_edict = yes
			NOT = {
				has_state_edict = edict_encourage_development
			}
		}
		edict_commander_set_edict_for_state = {
			edict = edict_encourage_development
		}
	}
}

on_mil_development = {
	if = {
		limit = {
			owner = {
				ai = no
			}
			is_state = yes
			can_change_state_edict = yes
			NOT = {
				has_state_edict = edict_encourage_development
			}
		}
		edict_commander_set_edict_for_state = {
			edict = edict_encourage_development
		}
	}
}
